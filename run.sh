#!/usr/bin/env bash

IMAGE_NAME='malware-injection:latest'
CONTAINER_NICKNAME='okearo'

# Build container image
docker build -t $IMAGE_NAME .

# Remove past runs
docker rm $CONTAINER_NICKNAME

# Run container
    # Using at most 5 CPU cores
    # Setting container name to run commands later
    # Mounting a read-only volume with code to easy up development
    # Mounting a volume with datasets
    # Run with an interative bash session
docker run \
    --cpuset-cpus="0-4" \
    --gpus all \
    --name $CONTAINER_NICKNAME  \
    --hostname $CONTAINER_NICKNAME  \
    -v $(pwd)/code:/usr/src/app/code \
    -v $(pwd)/data:/usr/data \
    -i -t $IMAGE_NAME bash

